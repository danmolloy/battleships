(this.webpackJsonpwarships=this.webpackJsonpwarships||[]).push([[0],{57:function(e,t,n){},58:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(18),i=n.n(s),l=(n(57),n(58),n(5)),o=n(13),c=function(){return Object(o.b)()},u=o.c,d=n(52),f=n(6),h=n.n(f),p=n(10),v=n(3),b=n(30),j=n.n(b),m=Object(v.b)("/api/get/users",Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("/api/get/users");case 2:return t=e.sent,e.abrupt("return",t.data.users);case 4:case"end":return e.stop()}}),e)})))),g=Object(v.b)("/api/post/users",function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/post/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(v.c)({name:"game",initialState:{inGame:"idle",turn:null,highScores:null,status:"idle",error:null},reducers:{toggleInGame:function(e,t){e.inGame=t.payload},setTurn:function(e){null===e.turn||"CPU"===e.turn?e.turn="Player":e.turn="CPU"}},extraReducers:function(e){e.addCase(m.pending,(function(e){e.status="loading"})).addCase(m.fulfilled,(function(e,t){e.status="succeeded",e.highScores=t.payload})).addCase(m.rejected,(function(e,t){e.status="failed",e.error=t.error.message})).addCase(g.fulfilled,(function(e,t){e.highScores=[].concat(Object(d.a)(e.highScores),[t.payload.user]).sort((function(e,t){return e.moves-t.moves}))}))}}),O=y.actions,x=O.toggleInGame,S=O.setTurn,k=y.reducer,w=function(e){return Math.floor(Math.random()*e)},P=function(e,t){var n=t.slice();return 1===w(2)?q(e,n):A(e,n)},C=function(e,t,n){for(var r=e;r<=t;r+=10)if(null!==n[r].val)return!1;return!0},q=function(e,t){for(var n=w(100-10*e),r=0;r<50;)if(0===n){if(C(0,n+10*e,t)&&C(1,n+(10*e+1),t))break;n=w(100-10*e),r=1}else if(9===n){if(C(9,n+10*e,t)&&C(8,n+(10*e-1),t))break;n=w(100-10*e),r=1}else if(n+10*e-10===99){if(C(n-10,99,t)&&C(n-11,98,t))break;n=w(100-10*e),r=1}else if(n+10*e-10===90){if(C(n-10,90,t)&&C(n-9,91,t))break;n=w(100-10*e),r=1}else if(n+10*e>89){if(C(n-10,n+(10*e-10),t)&&C(n-11,n+(10*e-11),t)&&C(n-9,n+(10*e-9),t))break;n=w(100-10*e),r=1}else if(n-10<0){if(C(n,n+10*e,t)&&C(n-1,n+(10*e-1),t)&&C(n+1,n+(10*e+1),t))break;n=w(100-10*e),r=1}else if(n%10===9){if(C(n-10,n+10*e,t)&&C(n-11,n+10*e-1,t))break;n=w(100-10*e),r=1}else if(n%10===0){if(C(n-10,n+10*e,t)&&C(n-9,n+10*e+1,t))break;n=w(100-10*e),r=1}else{if(C(n-10,n+10*e,t)&&C(n-11,n+10*e-1,t)&&C(n-9,n+1+10*e,t))break;n=w(100-10*e),r=1}if(!(r>=10)){for(var a=[],s=n;s<n+10*e;s+=10)a.push(s);return a}},N=function(e,t,n){for(var r=e;r<=t;r++)if(null!==n[r].val)return!1;return!0},U=function(e){return Number(String(w(10))+String(w(10-e)))},A=function(e,t){for(var n=U(e),r=0;r<50;){if(0===n){if(N(n,n+e,t)&&N(n+10,n+e+10,t))break;n=U(e)}else if(n+e-1===9){if(N(n-1,n+e-1,t)&&N(n+9,n+e+9,t))break;n=U(e)}else if(n+e-1===99){if(N(n-1,n+e-1,t)&&N(n-11,n+e-11,t))break;n=U(e)}else if(90===n){if(N(n,n+e,t)&&N(n-10,n+e-10,t))break;n=U(e)}else if(n<9){if(N(n-1,n+e,t)&&N(n+9,n+e+10,t))break;n=U(e)}else if(n%10===0){if(N(n,n+e,t)&&N(n-10,n+e-10,t)&&N(n+10,n+e+10,t))break;n=U(e)}else if((n+e-1)%10===9){if(N(n-1,n+e-1,t)&&N(n-11,n+e-11,t)&&N(n+9,n+e+9,t))break;n=U(e)}else if(n>90){if(N(n-1,n+e,t)&&N(n-11,n+e-10,t))break;n=U(e)}else{if(N(n-1,n+e,t)&&N(n-11,n+e-10,t)&&N(n+9,n+e+10,t))break;n=U(e)}r++}for(var a=[],s=n;s<n+e;s++)a.push(s);return a},M={CPUSquares:new Array(100).fill(null).map((function(e){return{id:Object(v.d)(),val:null}})),boardSet:!1,numAttacks:0},B=Object(v.c)({name:"cpuShips",initialState:M,reducers:{updateSquares:function(e,t){if(5===t.payload.length)for(var n=0;n<t.payload.length;n++)e.CPUSquares[t.payload[n]].val="(5) Carrier";else if(4===t.payload.length)for(var r=0;r<t.payload.length;r++)e.CPUSquares[t.payload[r]].val="(4) Battleship";else if(3===t.payload.length){if(!0===function(){for(var t=0;t<e.CPUSquares.length;t++)if("(3) Submarine"===e.CPUSquares[t].val)return!0;return!1}())for(var a=0;a<t.payload.length;a++)e.CPUSquares[t.payload[a]].val="(3) Destroyer";else for(var s=0;s<t.payload.length;s++)e.CPUSquares[t.payload[s]].val="(3) Submarine"}else if(2===t.payload.length)for(var i=0;i<t.payload.length;i++)e.CPUSquares[t.payload[i]].val="(2) PatrolBoat"},handleAttack:function(e,t){var n=e.CPUSquares.find((function(e){return e.id===t.payload}));null===(null===n||void 0===n?void 0:n.val)?n.val="O":null!==(null===n||void 0===n?void 0:n.val)&&void 0!==n&&(n.val="X"),e.numAttacks+=1},resetCPUBoard:function(e){e.CPUSquares=new Array(100).fill(null).map((function(e){return{id:Object(v.d)(),val:null}}))}}}),X=function(e){return e.cpuShips.CPUSquares},I=B.actions,T=I.handleAttack,E=I.updateSquares,G=I.resetCPUBoard,R=B.reducer,L=n(0),D=function(e){var t=u((function(e){return e.game.inGame})),n=e.whoAmI,a=c();Object(r.useEffect)((function(){"playing"===t&&0===s(e.squares).length&&(alert("".concat(n," wins")),a(x("ended")))}));var s=function(e){for(var t=[],n=0;n<e.length;n++)null!==e[n].val&&e[n].val.length>1&&!t.includes(e[n].val)&&t.push(e[n].val);return t.sort(),t.map((function(e){return Object(L.jsx)("p",{children:e})}))};return Object(L.jsxs)("div",{children:[Object(L.jsxs)("p",{children:["Attack count: ",e.attackCount]}),Object(L.jsx)("div",{children:Object(L.jsxs)("div",{onClick:function(){return e.showShips()},children:[Object(L.jsxs)("div",{children:[Object(L.jsxs)("p",{children:["Ships Remaining: ",s(e.squares).length]}),e.showList?Object(L.jsx)("i",{className:"up-arrow"}):Object(L.jsx)("i",{className:"down-arrow"})]}),e.showList&&s(e.squares)]})})]})},J=function(){var e=Object(r.useState)(!0),t=Object(l.a)(e,2),n=t[0],a=t[1],s=u((function(e){return e.cpuShips.CPUSquares})),i=u((function(e){return e.cpuShips.numAttacks})),o=u((function(e){return e.game.turn})),d=u((function(e){return e.game.inGame})),f=c();Object(r.useEffect)((function(){"playing"===d&&0===p().length&&alert("Player wins")}),[]);var h=s.map((function(e){return Object(L.jsx)("div",{className:"X"===e.val?"square-hit":"O"===e.val?"square":"square hover:bg-blue-500",onClick:function(){return function(e){var t=s.find((function(t){return t.id===e}));"Player"===o&&"O"!==(null===t||void 0===t?void 0:t.val)&&"X"!==(null===t||void 0===t?void 0:t.val)&&"playing"===d&&(f(T(e)),f(S()))}(e.id)},children:null===e.val||e.val.length>1?null:e.val},e.id)})),p=function(){for(var e=[],t=0;t<s.length;t++)null!==s[t].val&&s[t].val.length>1&&!e.includes(s[t].val)&&e.push(s[t].val);return e.sort(),e.map((function(e){return Object(L.jsx)("p",{children:e})}))};return Object(L.jsxs)("div",{className:"outer-board pb-1",id:"cpu-ships",children:[Object(L.jsx)("h3",{children:"CPU Ships"}),Object(L.jsx)("div",{className:"inner-board",children:h}),null!==o&&Object(L.jsx)(D,{attackCount:i,showShipsRemaining:n,squares:s.slice(),showList:n,showShips:function(){return a(!n)},whoAmI:"Player"})]})},F=function(e,t){return t.length>0?new Promise((function(n){return setTimeout((function(){return n({data:H(e,t)})}),500)})):new Promise((function(t){return setTimeout((function(){return t({data:W(e)})}),1e3)}))},W=function(e){for(var t=Math.floor(100*Math.random());"O"===e[t].val||"X"===e[t].val;)t=Math.floor(100*Math.random());return t},H=function(e,t){var n=0;if(1===t.length)for(var r=t[0],a=Math.floor(4*Math.random());n<10;){if(0===a){if("O"!==e[r-10].val&&"X"!==e[r-10].val&&r-10>=0)return r-10}else if(1===a){if("O"!==e[r+1].val&&"X"!==e[r+1].val&&r%10!==0)return r+1}else if(2===a){if("O"!==e[r+10].val&&"X"!==e[r+10].val&&r<=99)return r+10}else if(3===a&&"O"!==e[r-1].val&&"X"!==e[r-1].val&&r%10!==9)return r-1;a=Math.floor(4*Math.random()),n++}else for(;n<10;){if(n++,t[1]-t[0]===10){var s=t[t.length-1]+10;return"O"!==e[s].val&&"X"!==e[s].val&&s<=99?s:t[0]-10}var i=t[t.length-1]+1;return"O"!==e[i].val&&"X"!==e[i].val&&i%10!==10?i:t[0]-1}return 1},Y=function(e){for(var t=[],n=0;n<e.length;n++)null!==e[n].val&&e[n].val.length>1&&!t.includes(e[n].val)&&t.push(e[n].val);return t},z={PlayerSquares:new Array(100).fill(null).map((function(e){return{id:Object(v.d)(),val:null}})),boardSet:!1,numAttacks:0,currentAttack:[],CPUMove:"idle"},K=Object(v.b)("playerShips/fetchMove",function(){var e=Object(p.a)(h.a.mark((function e(t,n){var r,a,s,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState(),a=r.playerShips.currentAttack,s=r.playerShips.PlayerSquares,e.next=5,F(s,a);case 5:return i=e.sent,e.abrupt("return",i.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),$=Object(v.c)({name:"playerShips",initialState:z,reducers:{updateSquares:function(e,t){if(5===t.payload.length)for(var n=0;n<t.payload.length;n++)e.PlayerSquares[t.payload[n]].val="(5) Carrier";else if(4===t.payload.length)for(var r=0;r<t.payload.length;r++)e.PlayerSquares[t.payload[r]].val="(4) BattleShip";else if(3===t.payload.length){if(!0===function(){for(var t=0;t<e.PlayerSquares.length;t++)if("(3) Submarine"===e.PlayerSquares[t].val)return!0;return!1}())for(var a=0;a<t.payload.length;a++)e.PlayerSquares[t.payload[a]].val="(3) Destroyer";else for(var s=0;s<t.payload.length;s++)e.PlayerSquares[t.payload[s]].val="(3) Submarine"}else if(2===t.payload.length)for(var i=0;i<t.payload.length;i++)e.PlayerSquares[t.payload[i]].val="(2) PatrolBoat"},setCPUMove:function(e,t){e.CPUMove=t.payload},resetPlayerBoard:function(e){e.PlayerSquares=new Array(100).fill(null).map((function(e){return{id:Object(v.d)(),val:null}}))}},extraReducers:function(e){e.addCase(K.pending,(function(e){e.CPUMove="thinking"})).addCase(K.fulfilled,(function(e,t){var n=Y(e.PlayerSquares),r=t.payload;null!==e.PlayerSquares[r].val?(e.PlayerSquares[r].val="X",Y(e.PlayerSquares).length===n.length?(e.currentAttack.push(r),e.currentAttack.sort()):e.currentAttack=[]):e.PlayerSquares[r].val="O",e.numAttacks+=1,e.CPUMove="complete"}))}}),Q=function(e){return e.playerShips.PlayerSquares},V=$.actions,Z=V.updateSquares,_=V.setCPUMove,ee=V.resetPlayerBoard,te=$.reducer,ne=function(){var e=u((function(e){return e.game.highScores}));return Object(L.jsx)("div",{className:"flex flex-col m-4",children:Object(L.jsxs)("table",{children:[Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{children:"Name"}),Object(L.jsx)("th",{children:"Moves"})]}),e&&e.map((function(e){return Object(L.jsxs)("tr",{children:[Object(L.jsx)("td",{className:"p-2 border-r",children:e.name}),Object(L.jsx)("td",{className:"p-2",children:e.moves})]},e.id)}))]})})},re=[{text:"The aim of Battleships is to sink all of your opponents ships before they sink yours.",key:1},{text:"There are two 10 * 10 boards which represent a space of ocean. \n\n  One contains your ships, the other contains your opponent's.",key:2},{text:"Parts of a ship are represented with a \u2022 \n\n  There are small ships \u2022\u2022 \n\n  And large ships \u2022\u2022\u2022\u2022\u2022 \n \n  And ships in between.",key:3},{text:"Upon clicking Start, the boards are both rendered with following ships: \n\n  1 x Carrier (\u2022\u2022\u2022\u2022\u2022) \n\n  1 x Battleship (\u2022\u2022\u2022\u2022) \n\n  1 x Destroyer (\u2022\u2022\u2022) \n\n  1 x Submarine (\u2022\u2022\u2022) \n\n  1 x Patrol Boat (\u2022\u2022) \n",key:4},{text:"Players take turns attacking their opponents board, attempting to hit a ship. \n\n  A hit is represented by X, a miss is O. \n\n  Each player can only see their own ships.",key:5},{text:"If you hit, try the squares around that square to sink the entire ship. \n\n  The ships may be horizontal or vertical. They cannot be touching another ship (including a diagonal square). \n\n  You can see the ships remaining for both players, and will be notified when you sink one.",key:6}],ae=function(e){var t=Object(r.useState)(1),n=Object(l.a)(t,2),a=n[0],s=n[1];return Object(L.jsxs)("div",{className:"instructions-window",children:[Object(L.jsxs)("div",{className:"flex flex-row items-end self-end w-full p-2",children:[Object(L.jsx)("h2",{className:"self-center w-3/4",children:"Instructions"}),Object(L.jsx)("p",{className:"w-1/4",children:"".concat(a,"/").concat(re.length)})]}),Object(L.jsx)("div",{className:"my-4",children:re[a-1].text.split("\n").map((function(e){return Object(L.jsx)("p",{className:"p-2",children:e})}))}),Object(L.jsx)("div",{className:"flex flex-row justify-end w-full",children:Object(L.jsx)("button",{onClick:function(){a<re.length?s(a+1):e.close()},className:"self-end text-blue-500 hover:text-blue-700",children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(L.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})})})]})},se=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=c(),o=u((function(e){return e.cpuShips.numAttacks}));return Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{children:"Your name:"}),Object(L.jsx)("input",{className:"border px-1",value:a,onChange:function(e){return s(e.target.value)}}),Object(L.jsx)("button",{className:"header-btn text-gray-600 hover:bg-gray-300 focus:ring-gray-500",onClick:function(){return i(g({name:a,moves:o})),void e.hideForm()},children:"Submit"})]})},ie=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(!1),i=Object(l.a)(s,2),o=i[0],d=i[1],f=Object(r.useState)(!1),h=Object(l.a)(f,2),p=h[0],v=h[1],b=Object(r.useState)("Start"),j=Object(l.a)(b,2),g=j[0],y=j[1],O=u((function(e){return e.game.turn})),k=u((function(e){return e.game.inGame})),w=c();Object(r.useEffect)((function(){"ended"===k?(d(!0),y("Reset"),v(!0)):"playing"===k?y("Reset"):"idle"===k&&y("Start")}),[k]);return Object(L.jsxs)("div",{className:"header m-3",id:"header",children:[Object(L.jsx)("h1",{id:"title",className:"p-4",children:"ended"===k||"idle"===k?"Battleships":"".concat(O," turn")}),Object(L.jsxs)("div",{className:"flex flex-col sm:flex-row items-center",children:[Object(L.jsx)("button",{id:"status-btn",className:"header-btn bg-green-500 text-white hover:bg-green-600 focus:ring-green-400",onClick:function(){"idle"===k?(w((function(e,t){var n=X(t());e(E(P(5,n))),n=X(t()),e(E(P(4,n))),n=X(t()),e(E(P(3,n))),n=X(t()),e(E(P(3,n))),n=X(t()),e(E(P(2,n)))})),w((function(e,t){var n=Q(t());e(Z(P(5,n))),n=Q(t()),e(Z(P(4,n))),n=Q(t()),e(Z(P(3,n))),n=Q(t()),e(Z(P(3,n))),n=Q(t()),e(Z(P(2,n)))})),w(S()),w(x("playing"))):"playing"===k?window.location.reload():"ended"===k&&(w(G()),w(ee()),w(x("idle")),d(!1))},children:g}),Object(L.jsx)("button",{onClick:function(){return a(!n)},className:"header-btn bg-blue-500 text-white hover:bg-blue-600 focus:ring-gray-500",children:"Instructions"}),Object(L.jsx)("button",{className:"header-btn bg-gray-200 text-gray-600 hover:bg-gray-300 focus:ring-gray-500",onClick:function(){return d(!o),void w(m())},children:"High Scores"})]}),n&&Object(L.jsx)(ae,{close:function(){return a(!1)}}),o&&Object(L.jsx)(ne,{}),p&&Object(L.jsx)(se,{hideForm:function(){return v(!1)}})]})},le=function(){var e=Object(r.useState)(!0),t=Object(l.a)(e,2),n=t[0],a=t[1],s=u((function(e){return e.playerShips.PlayerSquares})),i=u((function(e){return e.playerShips.numAttacks})),o=u((function(e){return e.game.turn})),d=u((function(e){return e.playerShips.CPUMove})),f=u((function(e){return e.game.inGame})),v=c();Object(r.useEffect)((function(){"CPU"===o&&"idle"===d&&"playing"===f?j():"complete"===d&&v(_("idle"))}));var b=s.map((function(e){return Object(L.jsx)("div",{className:"X"===e.val?"square-hit":"square",children:null===e.val?null:e.val.length>1?"\u2022":e.val},e.id)})),j=function(){var e=Object(p.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("CPU"===o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,v(K());case 4:v(S());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(L.jsxs)("div",{className:"outer-board pb-1",id:"player-ships",children:[Object(L.jsx)("h3",{children:"Player Ships"}),Object(L.jsx)("div",{className:"inner-board",children:b}),null!==o&&Object(L.jsx)(D,{attackCount:i,showShipsRemaining:n,squares:s.slice(),showList:n,showShips:function(){return a(!n)},whoAmI:"CPU"})]})};var oe=function(){return Object(L.jsxs)("div",{className:"flex flex-col justify-center items-center text-center",children:[Object(L.jsx)(ie,{}),Object(L.jsxs)("div",{className:"flex flex-col sm:flex-row items-start",children:[Object(L.jsx)(J,{}),Object(L.jsx)(le,{})]})]})},ce=Object(v.a)({reducer:{game:k,cpuShips:R,playerShips:te}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=n(34);!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.environment,n=void 0===t?"test":t,r=Object(ue.b)({environment:n,models:{user:ue.a},routes:function(){this.namespace="api",this.get("/get/users",(function(){return{users:[{name:"Kelly",id:1,moves:38},{name:"Eoghan",id:2,moves:44},{name:"Fiona",id:3,moves:45},{name:"Ed",id:4,moves:48},{name:"Dan",id:5,moves:49},{name:"Jorge",id:6,moves:54}]}}),{timing:1e3});var e=7;this.post("/post/users",(function(t,n){var r=JSON.parse(n.requestBody);return r.id=e++,{user:r}}))}})}({environment:"development"}),i.a.render(Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(o.a,{store:ce,children:Object(L.jsx)(oe,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[85,1,2]]]);
//# sourceMappingURL=main.58dedbc6.chunk.js.map